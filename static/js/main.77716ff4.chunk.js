(this.webpackJsonprelpo=this.webpackJsonprelpo||[]).push([[0],{48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},55:function(e,t,n){},57:function(e,t,n){},62:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(24),r=n.n(s),i=(n(48),n(6)),l=(n(49),n(50),{appName:"Relpo"}),d=n(10),o=n.n(d),u=n(13),j=n(40).a.initializeApp({apiKey:"AIzaSyBsdIYSBkCehCj5krwFqFjEMAN_xz_VIvs",authDomain:"relpo-88360.firebaseapp.com",projectId:"relpo-88360",storageBucket:"relpo-88360.appspot.com",messagingSenderId:"10108693366",appId:"1:10108693366:web:5525d64140ffb296d2a857",measurementId:"G-66J2YL6KVW"});n(52);function b(){return(b=Object(u.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.auth().createUserWithEmailAndPassword(t,n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=Object(u.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.auth().signInWithEmailAndPassword(t,n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return O.apply(this,arguments)}function O(){return(O=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.auth().signOut();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=n(2);function p(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),r=Object(i.a)(s,2),d=r[0],o=r[1],u=Object(c.useState)(""),j=Object(i.a)(u,2),b=j[0],m=j[1],O=Object(c.useState)(""),p=Object(i.a)(O,2),f=p[0],v=p[1];return Object(x.jsx)("div",{className:"section1",children:Object(x.jsx)("div",{className:"container",id:"base",children:Object(x.jsxs)("div",{className:"row-fluid ",children:[Object(x.jsx)("div",{className:"col-fluid text-center",children:Object(x.jsx)("h3",{className:"display-1",children:l.appName})}),Object(x.jsx)("br",{}),Object(x.jsx)("div",{className:"row-fluid",children:Object(x.jsx)("div",{className:"col-fluid",children:Object(x.jsxs)("form",{onSubmit:function(e){e.preventDefault(),m(""),v(""),""!==n?!function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}(n)?m("Not valid email"):""!==d?d.length<6?v("Invalid Passsword"):function(e,t){return h.apply(this,arguments)}(n,d).catch((function(e){switch(console.log(e),e.code){case"auth/user-not-found":m("No such user found!");break;case"auth/wrong-password":v("Invalid Password!");break;default:v(e.message)}})):v("This field can't be empty"):m("This field can't be empty")},noValidate:!0,children:[Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Email address"}),Object(x.jsx)("input",{value:n,onChange:function(e){a(e.target.value)},type:"email",className:"form-control bg-dark",id:"exampleInputEmail1","aria-describedby":"emailHelp"}),Object(x.jsx)("small",{className:"text-danger",children:b})]}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"exampleInputPassword1",className:"form-label",children:"Password"}),Object(x.jsx)("input",{onChange:function(e){o(e.target.value)},value:d,type:"password",className:"form-control bg-dark",id:"exampleInputPassword1"}),Object(x.jsx)("small",{className:"text-danger",children:f})]}),Object(x.jsx)("button",{type:"submit",className:"btn btn-outline-dark mt-3",id:"loginb",children:"Login"})]})})})]})})})}n(55);var f=n(31),v=n(17),g=(n(70),{name:"",email:"",phone:-1,uuid:"",ridesJoined:[],ridesHosted:[]});function N(){return(N=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.firestore().collection("users").add(Object(v.a)(Object(v.a)({},g),t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.firestore().collection("users").where("email","==",t).get();case 2:if(!(n=e.sent)||n.empty||1!==n.docs.length||!n.docs[0].exists){e.next=7;break}return e.abrupt("return",n.docs[0]);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return k.apply(this,arguments)}function k(){return(k=Object(u.a)(o.a.mark((function e(t){var n,c,a,s,r,i,l,d,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,c=t.ridersCount,a=t.city,s=t.lat,r=t.long,i=t.uuid,l=t.host,d=t.participants,u=t.imageURL,console.log(l),e.next=4,j.firestore().collection("rides").add({name:n,ridersCount:c,city:a,lat:s,long:r,uuid:i,host:l,participants:d,imageURL:u});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return S.apply(this,arguments)}function S(){return(S=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.firestore().collection("users").doc(t).get();case 2:if(!(n=e.sent).exists){e.next=7;break}return e.abrupt("return",Object(v.a)(Object(v.a)({},n.data()),{},{uuid:n.id}));case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t,n){return I.apply(this,arguments)}function I(){return(I=Object(u.a)(o.a.mark((function e(t,n,c){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.firestore().collection("users").doc(t.uuid).update(c?{ridesHosted:[].concat(Object(f.a)(t.ridesHosted),[n])}:{ridesJoined:[].concat(Object(f.a)(t.ridesJoined),[n])});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return(R=Object(u.a)(o.a.mark((function e(t,n){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.firestore().collection("rides").where("uuid","==",n.uuid).get();case 2:if(c=e.sent.docs[0].id,!n.participants.includes(t.uuid)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,j.firestore().collection("rides").doc(c).update({participants:[].concat(Object(f.a)(n.participants),[t.uuid])});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=Object(u.a)(o.a.mark((function e(t,n){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.firestore().collection("rides").where("uuid","==",n.uuid).get();case 2:if(c=e.sent.docs[0].id,n.participants.includes(t)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,j.firestore().collection("rides").doc(c).update({participants:n.participants.filter((function(e){return e!==t}))});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),r=Object(i.a)(s,2),d=r[0],o=r[1],u=Object(c.useState)(""),j=Object(i.a)(u,2),h=j[0],m=j[1],O=Object(c.useState)(""),p=Object(i.a)(O,2),f=p[0],v=p[1],g=Object(c.useState)(""),w=Object(i.a)(g,2),y=w[0],k=w[1],A=Object(c.useState)(""),S=Object(i.a)(A,2),C=S[0],I=S[1],R=Object(c.useState)(""),E=Object(i.a)(R,2),L=E[0],D=E[1],H=Object(c.useState)(""),P=Object(i.a)(H,2),B=P[0],T=P[1];return Object(x.jsx)("div",{className:"section1",children:Object(x.jsx)("div",{className:"container",id:"base",children:Object(x.jsxs)("div",{className:"row-fluid ",children:[Object(x.jsx)("div",{className:"col-fluid text-center",children:Object(x.jsx)("h3",{className:"display-1",children:l.appName})}),Object(x.jsx)("br",{}),Object(x.jsx)("div",{className:"row-fluid",children:Object(x.jsx)("div",{className:"col-fluid",children:Object(x.jsxs)("form",{onSubmit:function(e){e.preventDefault(),T(""),I(""),o(""),v(""),""!==L?""!==n?!function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}(n)?o("Not valid email"):""!==h?""!==y?h.length<6?v("Passsword must be atleast 6 digits"):y===h?function(e,t){return b.apply(this,arguments)}(n,h).then((function(){!function(e){N.apply(this,arguments)}({email:n,name:L,phone:"nothing!!"})})).catch((function(e){switch(console.log(e),e.code){case"auth/email-already-in-use":o("Email already in use!");break;default:I(e.message)}})):I("Passwords don't match"):I("This field can't be empty"):v("This field can't be empty"):o("This field can't be empty"):T("This field can't be empty")},noValidate:!0,children:[Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"exampleInputPassword1",className:"form-label",children:"Name"}),Object(x.jsx)("input",{onChange:function(e){D(e.target.value)},value:L,type:"text",className:"form-control bg-dark",placeholder:"Name",id:"exampleInputPassword1"}),Object(x.jsx)("small",{className:"text-danger",children:B})]}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Email address"}),Object(x.jsx)("input",{value:n,onChange:function(e){a(e.target.value)},type:"email",className:"form-control bg-dark",placeholder:"Email address",id:"exampleInputEmail1","aria-describedby":"emailHelp"}),Object(x.jsx)("small",{className:"text-danger",children:d})]}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"exampleInputPassword1",className:"form-label",children:"Password"}),Object(x.jsx)("input",{onChange:function(e){m(e.target.value)},value:h,type:"password",className:"form-control bg-dark",placeholder:"Password",id:"exampleInputPassword1"}),Object(x.jsx)("small",{className:"text-danger",children:f})]}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"exampleInputPassword1",className:"form-label",children:"Retype Password"}),Object(x.jsx)("input",{onChange:function(e){k(e.target.value)},value:y,type:"password",className:"form-control bg-dark",placeholder:"Retype Password",id:"exampleInputPassword1"}),Object(x.jsx)("small",{className:"text-danger",children:C})]}),Object(x.jsx)("button",{type:"submit",className:"btn btn-outline-dark mt-3",id:"loginb",children:"Signup"})]})})})]})})})}var D=n(28),H=n(12),P=(n(57),{signUp:"/sign-up",logIn:"/login",dashBoard:"/dashboard",ride:"/ride/:rideID"});function B(){var e=Object(H.g)();return Object(x.jsx)("div",{className:"section1 min-vh-100 w-100 d-flex align-items-center",children:Object(x.jsx)("div",{className:"container",id:"base",children:Object(x.jsxs)("div",{className:"row-fluid text-center",children:[Object(x.jsxs)("div",{className:"col-fluid",children:[Object(x.jsx)("h1",{className:"display-3",children:"Welcome To "}),Object(x.jsx)("h3",{className:"display-1",children:l.appName})]}),Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"row-fluid",children:[Object(x.jsx)("div",{className:"col-fluid",children:Object(x.jsx)("button",{onClick:function(){e.push(P.logIn)},type:"button",className:"btn btn-outline-dark",id:"loginb",children:"Login"})}),Object(x.jsx)("br",{}),Object(x.jsx)("div",{className:"col-fluid",children:Object(x.jsx)("button",{onClick:function(){e.push(P.signUp)},type:"button",className:"btn btn-dark",id:"signupb",children:"Signup"})})]})]})})})}var T=n(29),U=Object(c.createContext)([void 0,null]);function M(){return Object(c.useContext)(U)}function F(e){var t=e.children,n=Object(c.useState)(void 0),a=Object(i.a)(n,2),s=a[0],r=a[1];return Object(c.useEffect)((function(){j.auth().onAuthStateChanged((function(e){e&&e.email?function(e){return w.apply(this,arguments)}(e.email).then((function(e){r(null===e?null:Object(v.a)(Object(v.a)({},e.data()),{},{uuid:e.id}))})):r(null)}))}),[]),Object(x.jsx)(U.Provider,{value:[s,r],children:t})}n(62);var J=n(73),z=n(74),V=n(76),K=function(){var e=Object(c.useState)({}),t=Object(i.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(null),r=Object(i.a)(s,2),l=r[0],d=r[1],o=function(e){var t=e.coords;a({latitude:t.latitude,longitude:t.longitude})},u=function(e){d(e.message)};return Object(c.useEffect)((function(){var e=navigator.geolocation;if(e){var t=e.watchPosition(o,u);return function(){return e.clearWatch(t)}}d("Geolocation is not supported")}),[]),{latitude:n.latitude,longitude:n.longitude,error:l}},Y=n(75);function Q(e){var t=e.ride,n=M(),c=Object(i.a)(n,1)[0];return Object(x.jsx)("div",{className:"card mb-3",children:Object(x.jsxs)("div",{className:"d-flex align-items-center flex-wrap g-0",children:[Object(x.jsx)("div",{className:"p-2",children:Object(x.jsx)("img",{className:"m-2",width:120,height:120,src:""!==t.imageURL?t.imageURL:"https://www.iconbunny.com/icons/media/catalog/product/3/3/332.9-cycle-icon-iconbunny.jpg",alt:"ride"})}),Object(x.jsx)("div",{className:"flex-grow-1",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title",children:[t.name," Ride"]}),Object(x.jsxs)("p",{className:"card-text",children:[Object(x.jsx)("table",{className:"table",children:Object(x.jsxs)("tbody",{children:[Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"Distance"})}),Object(x.jsxs)("td",{children:[t.distance.toFixed(),"km"]})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"Riders"})}),Object(x.jsx)("td",{children:t.ridersCount})]})]})}),Object(x.jsx)("div",{className:"badge badge-warning m-2",style:{height:20},children:t.host===(null===c||void 0===c?void 0:c.uuid)&&"You are the Host"})]})]})})]})})}function q(e){var t=e.ride,n=e.closeRideInfo,c=M(),a=Object(i.a)(c,1)[0],s=Object(H.g)();return Object(x.jsx)("div",{className:"card mb-3",children:Object(x.jsx)("div",{className:"row g-0",children:Object(x.jsx)("div",{className:"col-md-12",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("img",{className:"m-2",width:120,height:120,src:""!==t.imageURL?t.imageURL:"https://www.iconbunny.com/icons/media/catalog/product/3/3/332.9-cycle-icon-iconbunny.jpg",alt:"ride"}),Object(x.jsx)("h5",{className:"card-title",children:t.name}),Object(x.jsxs)("p",{className:"card-text",children:[Object(x.jsx)("table",{className:"table",children:Object(x.jsxs)("tbody",{children:[Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"Distance"})}),Object(x.jsxs)("td",{children:[t.distance.toFixed(),"m"]})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"Riders"})}),Object(x.jsx)("td",{children:t.ridersCount})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"City"})}),Object(x.jsx)("td",{children:t.city})]})]})}),Object(x.jsx)("button",{onClick:function(){a&&C(a,t.uuid,!1).then((function(){return function(e,t){return R.apply(this,arguments)}(a,t).then((function(){n(),s.push("/ride/"+t.uuid)}))}))},className:"btn btn-dark",children:"Join"})]})]})})})})}n(69);var G=function(){var e=Object(u.a)(o.a.mark((function e(t,n){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=j.storage().ref("".concat(t.email,"/buttonImage/").concat(n.name)),e.next=3,c.put(n);case 3:return e.next=5,c.getDownloadURL();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Z(e){return e*Math.PI/180}function W(e,t,n,c){var a=Z(e-n),s=Z(t-c),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(Z(e))*Math.cos(Z(n))*Math.sin(s/2)*Math.sin(s/2);return 6378137*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))/1e3}function X(){var e=M(),t=Object(i.a)(e,1)[0],n=K(),a=n.latitude,s=n.longitude,r=Object(c.useState)(!1),l=Object(i.a)(r,2),d=l[0],b=l[1],h=Object(c.useState)(!1),O=Object(i.a)(h,2),p=O[0],f=O[1],g=Object(c.useState)(),N=Object(i.a)(g,2),w=N[0],k=N[1],S=Object(c.useState)(void 0),I=Object(i.a)(S,2),R=I[0],E=I[1],L=Object(c.useState)(""),D=Object(i.a)(L,2),P=D[0],B=D[1],U=Object(c.useState)(0),F=Object(i.a)(U,2),Z=F[0],X=F[1],_=Object(c.useState)(""),$=Object(i.a)(_,2),ee=$[0],te=$[1],ne=Object(c.useState)(!1),ce=Object(i.a)(ne,2),ae=ce[0],se=ce[1],re=Object(c.useState)(null),ie=Object(i.a)(re,2),le=ie[0],de=ie[1],oe=Object(H.g)(),ue=Object(c.useState)(!1),je=Object(i.a)(ue,2),be=je[0],he=je[1];function me(){return(me=Object(u.a)(o.a.mark((function e(n){var c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),se(!0),c="",!w){e.next=7;break}return e.next=6,G(t,w);case 6:c=e.sent;case 7:if(""!==P){e.next=9;break}return e.abrupt("return");case 9:if(""!==ee){e.next=11;break}return e.abrupt("return");case 11:r=Object(Y.a)(),t&&y({name:P,ridersCount:Z,city:ee,lat:a,long:s,uuid:r,host:null===t||void 0===t?void 0:t.uuid,participants:[],imageURL:c}).then((function(){C(t,r,!0),b(!1),oe.push("/ride/"+r),B(""),X(0),te(""),se(!1)}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(u.a)(o.a.mark((function e(t){var n,c,r,i,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(a),n=[],c=Object(T.a)(t),e.prev=3,c.s();case 5:if((r=c.n()).done){e.next=13;break}return i=r.value,e.next=9,A(i.host);case 9:l=e.sent,n.push(Object(v.a)(Object(v.a)({},i),{},{distance:W(i.lat,i.long,a,s),user:l}));case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),c.e(e.t0);case 18:return e.prev=18,c.f(),e.finish(18);case 21:return n.sort((function(e,t){return e.distance-t.distance})),e.abrupt("return",n);case 23:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}return Object(c.useEffect)((function(){function e(){return(e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe(R);case 2:t=e.sent,E((function(e){return t}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s&&a&&R&&function(){e.apply(this,arguments)}()}),[a,s]),Object(c.useEffect)((function(){!R&&s&&a&&j.firestore().collection("rides").onSnapshot(function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.docs.forEach((function(e){return n.push(e.data())})),e.t0=E,e.next=5,Oe(n);case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[a,s]),Object(x.jsxs)("div",{className:"section1",children:[Object(x.jsxs)(J.a,{centered:!0,show:be,onHide:function(){return he(!1)},children:[Object(x.jsx)(J.a.Header,{closeButton:!0,children:"Your Rides"}),Object(x.jsxs)(J.a.Body,{children:[t&&R&&R.filter((function(e){return e.host===(null===t||void 0===t?void 0:t.uuid)||e.participants.includes(null===t||void 0===t?void 0:t.uuid)})).length>0&&R.filter((function(e){return e.host===(null===t||void 0===t?void 0:t.uuid)||e.participants.includes(null===t||void 0===t?void 0:t.uuid)})).map((function(e){return Object(x.jsx)("div",{onClick:function(){return oe.push("/ride/"+e.uuid)},className:"pointer-on-hover",children:Object(x.jsx)(Q,{ride:e})})})),t&&R&&0===R.filter((function(e){return e.host===(null===t||void 0===t?void 0:t.uuid)||e.participants.includes(null===t||void 0===t?void 0:t.uuid)})).length&&Object(x.jsx)("div",{className:"text-danger text-center",children:"YOU HAVE NOT HOSTED OR JOINED ANY RIDES YET."})]})]}),Object(x.jsxs)(J.a,{centered:!0,show:null!==le,onHide:function(){de(null),f(!0)},children:[Object(x.jsxs)(J.a.Header,{closeButton:!0,children:["Book ",null===le||void 0===le?void 0:le.name]}),Object(x.jsx)(J.a.Body,{children:le&&Object(x.jsx)(q,{closeRideInfo:function(){return de(null)},ride:le})})]}),Object(x.jsxs)(J.a,{centered:!0,show:d,onHide:function(){return b(!1)},children:[Object(x.jsx)(J.a.Header,{closeButton:!0,children:"Host a ride"}),Object(x.jsx)(J.a.Body,{children:Object(x.jsxs)(z.a,{onSubmit:function(e){return me.apply(this,arguments)},children:[Object(x.jsxs)(z.a.Group,{children:[Object(x.jsx)(z.a.Label,{children:"Ride Name"}),Object(x.jsx)(z.a.Control,{value:P,onChange:function(e){return B(e.target.value)}})]}),Object(x.jsxs)(z.a.Group,{children:[Object(x.jsx)(z.a.Label,{children:"No. of riders"}),Object(x.jsx)(z.a.Control,{value:Z,onChange:function(e){parseInt(e.target.value)>=0&&X(parseInt(e.target.value))},type:"number"})]}),Object(x.jsxs)(z.a.Group,{children:[Object(x.jsx)(z.a.Label,{children:"City/Area"}),Object(x.jsx)(z.a.Control,{value:ee,onChange:function(e){return te(e.target.value)}})]}),Object(x.jsxs)(z.a.Group,{children:[Object(x.jsx)(z.a.Label,{children:"Add Image (Optional)"}),Object(x.jsxs)("div",{className:"d-flex align-items-center justify-content-center pointer-on-hover",style:{backgroundColor:"#F4F5F8",height:109,width:92},onClick:function(){var e;return null===(e=document.getElementById("choose_pp"))||void 0===e?void 0:e.click()},children:[Object(x.jsx)("img",{alt:"plus",height:w?109:27,width:w?92:27,src:w?URL.createObjectURL(w):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACmSURBVHgB7ZThCQMhDIVjaPfoCA5QOB2hI3SyjtAR9KADOEL3KJyNhwfFXz6KR6H5QDBC8oHiMwQQQjgxH2+ydbLSsrwu3vtnbz8TgIjuVVSwVdzfTxi2qR0BoLKvUJnK/lRmmggaxRpthxpBlsayRhvvINpwRRZpHxLLXV5zpkQDkfmxvJlBmub5kduzaTp3z9BPrTKV/Z4sNjWUPJDsM9q2CEL63zJLNHtZpORKAAAAAElFTkSuQmCC"}),Object(x.jsx)("input",{id:"choose_pp",style:{display:"none"},type:"file",onChange:function(e){k(e.target.files[0])}})]})]}),Object(x.jsx)(V.a,{disabled:ae,variant:"dark",className:"rounded-pill",type:"submit",children:ae?"Loading..":"Host Now"})]})})]}),Object(x.jsxs)(J.a,{centered:!0,show:p,onHide:function(){return f(!1)},children:[Object(x.jsx)(J.a.Header,{closeButton:!0,children:"Join a ride"}),Object(x.jsxs)(J.a.Body,{children:[!le&&R&&R.filter((function(e){return e.host!==(null===t||void 0===t?void 0:t.uuid)})).length>0&&R.filter((function(e){return e.host!==(null===t||void 0===t?void 0:t.uuid)})).map((function(e){return Object(x.jsx)("div",{onClick:function(){f(!1),setTimeout((function(){return de(e)}),100)},className:"pointer-on-hover",children:Object(x.jsx)(Q,{ride:e},e.uuid)})})),!le&&R&&0===R.filter((function(e){return e.host!==(null===t||void 0===t?void 0:t.uuid)})).length&&Object(x.jsx)("div",{className:"text-center text-danger",children:"NO RIDES NEAR YOU! "})]})]}),Object(x.jsx)("div",{className:"container",id:"base",children:Object(x.jsxs)("div",{className:"row-fluid ",children:[Object(x.jsx)("div",{className:"col-fluid text-center text-inline",children:Object(x.jsxs)("h3",{className:"display-2",children:["Hi,",null===t||void 0===t?void 0:t.name]})}),Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"row d-flex flex-row justify-content-around",id:"btncontainer",children:[Object(x.jsx)("div",{className:"col-fluid",children:Object(x.jsx)("button",{type:"button",className:"btn btn-dark",id:"buttonsbox",onClick:function(){return b(!0)},children:"HOST"})}),Object(x.jsx)("div",{className:"col-fluid",children:Object(x.jsx)(V.a,{type:"button",className:"btn btn-dark",id:"buttonsbox",onClick:function(){return he(!0)},children:"YOUR RIDES"})}),Object(x.jsx)("div",{className:"col-fluid",children:Object(x.jsx)("button",{onClick:function(){return f(!0)},type:"button",className:"btn btn-dark",id:"buttonsbox",children:"JOIN"})}),Object(x.jsx)("div",{className:"col-fluid",children:Object(x.jsx)("button",{onClick:m,type:"button",className:"btn btn-dark text-wrap",id:"buttonsbox",children:"SIGN OUT"})})]})]})})]})}function _(){return Object(x.jsx)("div",{className:"display-3 d-flex align-items-center justify-content-center min-vh-100",children:"Loading..."})}function $(e){var t=e.ride,n=Object(c.useState)([]),a=Object(i.a)(n,2),s=a[0],r=a[1],l=Object(c.useState)(""),d=Object(i.a)(l,2),o=d[0],u=d[1],b=M(),h=Object(i.a)(b,1)[0];return Object(c.useEffect)((function(){j.firestore().collection("rides").doc(t.docID).collection("chats").onSnapshot((function(e){var t,n=[];e.docs.forEach((function(e){return n.push(e.data())})),n.sort((function(e,t){return e.timestamp-t.timestamp})),r(n);var c=null===(t=document)||void 0===t?void 0:t.querySelector("#chat-box");c&&(c.scrollTop=c.scrollHeight-c.clientHeight)}))}),[t.docID]),Object(x.jsxs)("div",{className:"container min-vh-50",children:[Object(x.jsx)("div",{id:"chat-box",className:"row-fluid min-vh-75 overflow-auto mb-4 p-2",style:{height:500},children:s.map((function(e){return Object(x.jsxs)("div",{className:e.sender.uuid===(null===h||void 0===h?void 0:h.uuid)?"text-right":"text-left",children:[Object(x.jsx)("div",{children:e.message}),Object(x.jsxs)("small",{className:"text-muted",children:[e.sender.name," |"," ",new Date(e.timestamp).toLocaleTimeString()]})]})}))}),Object(x.jsx)("div",{className:"row-fluid flex-grow-1 d-flex",children:Object(x.jsx)(z.a,{className:"w-100",onSubmit:function(e){e.preventDefault(),""!==o&&(j.firestore().collection("rides").doc(t.docID).collection("chats").add({message:o,sender:h,timestamp:(new Date).getTime()}),u(""))},children:Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Send a message","aria-label":"Recipient's username","aria-describedby":"button-addon2",value:o,onChange:function(e){return u(e.target.value)}}),Object(x.jsx)("button",{className:"btn btn-outline-secondary",type:"submit",id:"button-addon2",disabled:""===o,children:"Send"})]})})})]})}var ee=n.p+"static/media/user.c2876ea8.png";function te(e){return e*Math.PI/180}function ne(){var e=Object(H.h)(),t=Object(H.g)(),n=K(),a=n.latitude,s=n.longitude,r=M(),l=Object(i.a)(r,1)[0],d=Object(c.useState)(void 0),b=Object(i.a)(d,2),h=b[0],m=b[1],O=Object(c.useState)([]),p=Object(i.a)(O,2),f=p[0],g=p[1],N=Object(c.useState)(null),w=Object(i.a)(N,2),y=w[0],k=w[1],S=Object(c.useState)(!1),C=Object(i.a)(S,2),I=C[0],R=C[1],L=Object(c.useState)(0),D=Object(i.a)(L,2),P=D[0],B=D[1];function U(){return(U=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.firestore().collection("rides").doc(null===h||void 0===h?void 0:h.docID).get();case 2:e.sent.ref.delete(),t.push("/home");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){j.firestore().collection("rides").where("uuid","==",e.rideID).onSnapshot((function(e){if(e&&1===e.docs.length){if(!l)return;var n=e.docs[0].data();n.participants.includes(null===l||void 0===l?void 0:l.uuid)||n.host===l.uuid?m(Object(v.a)(Object(v.a)({},n),{},{docID:e.docs[0].id})):t.push("/home")}else t.push("/home")}))}),[e.rideID]),Object(c.useEffect)((function(){h&&B(function(e,t,n,c){var a=te(e-n),s=te(t-c),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(te(e))*Math.cos(te(n))*Math.sin(s/2)*Math.sin(s/2);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*6378137/1e3}(h.lat,h.long,a,s))}),[h,a,s]),Object(c.useEffect)((function(){function e(){return(e=Object(u.a)(o.a.mark((function e(){var t,n,c,a,s,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=26;break}return e.next=3,A(h.host);case 3:(t=e.sent)&&k(t),n=[],c=Object(T.a)(h.participants),e.prev=7,c.s();case 9:if((a=c.n()).done){e.next=17;break}return s=a.value,e.next=13,A(s);case 13:(r=e.sent)&&n.push(r);case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),c.e(e.t0);case 22:return e.prev=22,c.f(),e.finish(22);case 25:g(n);case 26:case"end":return e.stop()}}),e,null,[[7,19,22,25]])})))).apply(this,arguments)}h&&function(){e.apply(this,arguments)}()}),[h]),void 0===h?Object(x.jsx)(_,{}):null===h?Object(x.jsx)("div",{children:"NOT FOUND :("}):Object(x.jsxs)("div",{className:"container min-vh-100 ",children:[Object(x.jsxs)(J.a,{centered:!0,show:I,onHide:function(){return R(!1)},children:[Object(x.jsx)(J.a.Header,{closeButton:!0,children:"Chat"}),Object(x.jsx)(J.a.Body,{children:Object(x.jsx)($,{ride:h})})]}),Object(x.jsxs)("div",{className:"row ",children:[Object(x.jsx)("div",{className:"col-md-8 p-3 d-flex align-items-center justify-content-center",children:Object(x.jsx)("span",{className:"border border-dark w-100",children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("div",{className:"card-header",children:h.name}),Object(x.jsxs)("div",{className:"row g-0",children:[Object(x.jsx)("div",{className:"col-md-4 d-flex justify-content-center align-items-center",children:Object(x.jsx)("img",{height:128,width:128,src:""!==h.imageURL?h.imageURL:"https://www.iconbunny.com/icons/media/catalog/product/3/3/332.9-cycle-icon-iconbunny.jpg",alt:"...",className:"img-fluid m-3"})}),Object(x.jsx)("div",{className:"badge badge-warning",style:{height:20}}),Object(x.jsx)("div",{className:"col-md-8 ",children:Object(x.jsxs)("div",{className:"card-body",children:[y&&Object(x.jsxs)("h5",{className:"card-title",children:[null===y||void 0===y?void 0:y.name,"'s Ride"]}),Object(x.jsx)("p",{className:"card-text",children:Object(x.jsx)("table",{className:"table",children:Object(x.jsxs)("tbody",{children:[Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"Distance"})}),Object(x.jsxs)("td",{children:[P.toFixed(),"km"]})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"Riders"})}),Object(x.jsx)("td",{children:h.ridersCount})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"Area"})}),Object(x.jsx)("td",{children:h.city})]})]})})})]})})]})]})})}),Object(x.jsxs)("div",{className:"col-md-4 d-flex align-items-center  p-3 justify-content-center flex-column",children:[Object(x.jsx)("button",{onClick:function(){return R(!0)},className:"btn btn-outline-dark flex-grow-1 w-100 mb-1 ",children:"CHAT"}),(null===l||void 0===l?void 0:l.uuid)===h.host&&Object(x.jsx)("button",{onClick:function(){return U.apply(this,arguments)},className:"btn btn-outline-danger flex-grow-1 w-100 mb-1 ",children:"DELETE RIDE"})]})]}),f.length>0&&Object(x.jsx)("div",{className:"row d-flex align-items-center justify-content-center mt-4",children:Object(x.jsx)("h2",{children:"PARTICIPANTS"})}),f.map((function(e){return Object(x.jsxs)("div",{className:"row mt-4",children:[Object(x.jsx)("div",{className:"col-md-8",children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("div",{className:"card-header",children:e.name}),Object(x.jsxs)("div",{className:"row g-0",children:[Object(x.jsx)("div",{className:"col-md-4 d-flex justify-content-center align-items-center",children:Object(x.jsx)("img",{src:ee,alt:"...",className:"img-fluid"})}),Object(x.jsx)("div",{className:"badge badge-warning",style:{height:20}}),Object(x.jsx)("div",{className:"col-md-8 ",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{className:"card-title",children:e.name}),Object(x.jsx)("p",{className:"card-text",children:Object(x.jsx)("table",{className:"table",children:Object(x.jsx)("tbody",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("strong",{children:"Email"})}),Object(x.jsx)("td",{children:e.email})]})})})})]})})]})]})}),(null===l||void 0===l?void 0:l.uuid)===h.host&&Object(x.jsx)("div",{className:"col-md-4  d-flex align-items-center justify-content-center flex-column",children:Object(x.jsx)("button",{onClick:function(){!function(e,t){E.apply(this,arguments)}(e.uuid,h)},className:"btn btn-danger flex-grow-1 w-100 mt-1",children:"KICK"})})]})}))]})}var ce=function(){var e=M(),t=Object(i.a)(e,1)[0];return void 0===t?Object(x.jsx)(_,{}):Object(x.jsx)(D.a,{children:Object(x.jsxs)(H.d,{children:[Object(x.jsx)(H.b,{exact:!0,path:"/",children:t?Object(x.jsx)(H.a,{to:"/home"}):Object(x.jsx)(B,{})}),Object(x.jsx)(H.b,{path:"/home",children:t?Object(x.jsx)(X,{}):Object(x.jsx)(H.a,{to:"/"})}),Object(x.jsx)(H.b,{path:P.signUp,children:t?Object(x.jsx)(H.a,{to:"/home"}):Object(x.jsx)(L,{})}),Object(x.jsx)(H.b,{path:P.logIn,children:t?Object(x.jsx)(H.a,{to:"/home"}):Object(x.jsx)(p,{})}),Object(x.jsx)(H.b,{path:P.ride,children:t?Object(x.jsx)(ne,{}):Object(x.jsx)(H.a,{to:"/"})})]})})},ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,77)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),s(e),r(e)}))};n(64),n(65);r.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(F,{children:Object(x.jsx)(ce,{})})}),document.getElementById("root")),ae()}},[[68,1,2]]]);
//# sourceMappingURL=main.77716ff4.chunk.js.map